<!DOCTYPE html>
<!-- This site was created in Webflow. https://www.webflow.com -->
<!-- Last Published: Thu May 18 2023 15:06:15 GMT+0000 (Coordinated Universal Time) -->
<html data-wf-domain="">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>JudgeGPT</title>

        <!-- Bookstrap -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">

        <style>
        </style>

    </head>

    <body class="body">

        <!-- Bookstrap -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" crossorigin="anonymous"></script>
  
            <h1 class="logo">JudgeGPT</h1>

            <div id="chat"></div>
            <div id="inputGroup">
                <div id="instructions"></div>
                <input  id="userInput" type="text" placeholder="Plaintiff" value="" />
                <button id="submitButton" class="button w-button" onclick="Next()">
                    Submit
                </button>
            </div>
            


    <script>


        // Define global variables
        const chatDiv = document.getElementById('chat');
        const submitButton = document.getElementById('submitButton');
        const userInputFeild = document.getElementById('userInput');
        const inputGroup = document.getElementById('inputGroup');
        const instructionFeild = document.getElementById('instructions');

        //const caseDiv = document.getElementById('case');
        const outputDiv = document.getElementById('output');
        let progressInterval = {};

        let player = {};
        player[0] = {};
        player[0].name = "Plaintiff";
        player[0].instruction = "Plaintiff, do you have anything to add?";
        player[0].testimony;

        player[1] = {};
        player[1].name = "Defendant";
        player[1].instruction = "Defendant, what is your repsonse?";
        player[1].testimony;

        let judge = {}
        judge.name = "JudgeGPT";

        var turn = 0;

        var gameCase = "undefined";
        var casePrompt = "Come up with an abusrd or hilarious accursation to be argued in court between two parties.";
        
        Start();

        // Define asynchronous function to send data
        async function Start() {

            inputGroup.hidden = true;
            try {
                    //console.log("progressInterval = setInterval(async function(){\n                try {");

                    // Make POST request to updateUnFake
                    const response = await fetch('http://3.24.141.2:3000/AskGPT', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ prompt: casePrompt }),
                    });
                    
                    // Parse response data
                    const data = await response.json();
                    gameCase = data.generatedText;

                    AddToChat(judge, gameCase);
                    UpdateGameState();
                    inputGroup.hidden = false;

                    //ReadText(data.generatedText);

                } catch(error) {
                    // If an error occurs, log it and update loading element
                    console.error("Error fetching update: ", error);
                    caseDiv.innerText = "Server unresponsive...";
                    clearInterval(progressInterval);
                }
        }

        function AddToChat(playerSpeaking, chat)
        {
            const newChat = document.createElement('div');
            newChat.classList.add("row");
            newChat.classList.add("message");

            const messageContents = document.createElement('div');
            newChat.classList.add("col");
            const sender = document.createElement('div');
            newChat.classList.add("col-1");

            sender.innerText = playerSpeaking.name;
            messageContents.innerText = chat;

            newChat.appendChild(sender);
            newChat.appendChild(messageContents);
            chatDiv.appendChild(newChat);
        }

        function UpdateGameState()
        {
            console.log(player.name);
            console.log(player[turn]);
            console.log(player[turn].instruction);
            instructionFeild.innerText = player[turn].instruction;
            userInputFeild.value = "";
            userInputFeild.placeholder = player[turn].name;
        }

        

        // Define asynchronous function to send data
        async function Next() {

                player[turn].testimony = userInputFeild.value;

                AddToChat(player[turn], player[turn].testimony);

                if(turn == 0)
                {
                    turn++;
                    UpdateGameState();
                }else
                    DrawConclusion();
        }

        async function DrawConclusion() 
        {

            inputGroup.hidden = true;
            var prompt = "You are a judge in a televised small claims court TV show. You are creating a story and drawing your conclusion and announcing the verdict based on the following evidence.  Justify your verdict, and provide a funny, absurd and unfitting punishment and lesson to be learnt . The case is:" + gameCase + ". The Plaintiff testimony is: " + player[0].testimony + " The Defendant defence testimony is: " + player[1].testimony;

            // Disable the submit button
            submitButton.disabled = true;
            

            try {
                    console.log("progressInterval = setInterval(async function(){\n                try {");

                    // Make POST request to updateUnFake
                    const response = await fetch('http://3.24.141.2:3000/AskGPT', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ prompt: prompt }),
                    });
                    
                    // Parse response data
                    const data = await response.json();
                    AddToChat("JudgeGPT: "+data.generatedText);

                    //ReadText(data.generatedText);

                } catch(error) {
                    // If an error occurs, log it and update loading element
                    console.error("Error fetching update: ", error);
                    AddToChat("JudgeGPT: Server unresponsive...");
                    //outputDiv.innerText = "Server unresponsive...";
                    clearInterval(progressInterval);
                }
/*
            // Set interval for progress updates
            progressInterval = setInterval(async function(){
                //interval
            }, 1000);  // Interval of 2 seconds
*/
        }

        /*function ReadText(textInput)
        {
            const voice = require('elevenlabs-node');
            const fs = require('fs');

            const apiKey = process.env.ELEVENLABS_API_KEY;
            //const apiKey = '0e2c037kl8561005671b1de345s8765c'; // Your API key from Elevenlabs
            const voiceID = 'pNInz6obpgDQGcFmaJgB';            // The ID of the voice you want to get
            const fileName = 'audio.mp3';                      // The name of your audio file
            //const textInput = 'mozzy is cool';                 // The text you wish to convert to speech

            voice.textToSpeech(apiKey, voiceID, fileName, textInput).then(res => {
                console.log(res);

                // Play the audio file after text to speech conversion is done
                player.play('audio.mp3', function(err){
                  if (err) throw err;
                });
            });
        }*/
    </script>
    </body>
</html>